<!DOCTYPE html>
<html>

<head>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-119235055-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-119235055-1');
  </script>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Ryan Jan  | PowerShell Tips: What is splatting and should I use it?</title>
  <meta name="viewport" content="width=device-width,minimum-scale=1">
  <META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="/css/screen.css" />

  
  <link rel="stylesheet" type="text/css" href="/css/custom/screen-custom.css" />
  <link rel="stylesheet" type="text/css" href="/css/fontawesome_all.min.css" />
  <link rel="stylesheet" type="text/css" href="/css/prism.css" />
  <link rel="stylesheet" type="text/css" href="/css/custom/prism-custom.css" />
  <link rel="stylesheet" type="text/css" href="/css/custom/global-custom.css" />

  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700" rel="stylesheet">

  
  <script data-ad-client="ca-pub-8907477009760148" async
    src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  
</head>





<body class='post-template' >
  <div class="viewport">
    <header id="gh-head" class="gh-head">
      <nav class="gh-head-inner inner gh-container">

        <div class="gh-head-brand">
          <a class="gh-head-logo" href="/">
            <img src="/images/favicon.png" />
          </a>
          <a class="gh-burger" role="button">
            <div class="gh-burger-box">
              <div class="gh-burger-inner"></div>
            </div>
          </a>
        </div>
        <div class="gh-head-menu">
          <ul class="nav">
    <li class="nav-home nav-current"><a href="/">Home</a></li>
    <li class="nav-about"><a href="/about/">About</a></li>
</ul>

        </div>
        <div class="gh-head-actions">
          <div class="gh-social">
            <a class="gh-social-github" href="https://github.com/ryan-jan" title="GitHub" target="_blank"
              rel="noopener">
              <i class="fab fa-github fa-lg"></i>
            </a>
            <a class="gh-social-twitter" href="https://twitter.com/_ryanjan_" title="Twitter" target="_blank"
              rel="noopener">
              <i class="fab fa-twitter fa-lg"></i>
            </a>
          </div>
          <a class="gh-head-button su-modal-open-button" href="#/subscribe">Subscribe</a>
        </div>
      </nav>
    </header>
    <main>
      
<article class="article">
    <header class="article-header gh-canvas">
        
        
        
        <section class="article-tag">
            <a href="/tags/powershell">powershell</a>
        </section>
        
        

        <h1 class="article-title">PowerShell Tips: What is splatting and should I use it?</h1>

        

        <div class="article-byline">
            <section class="article-byline-content">
                
                
                
                
                
                <ul class="author-list">
                    <li class="author-list-item">
                        
                        <a href="https://ryanjan.uk/authors/ryan/" class="author-avatar">
                            
                            <img class="author-profile-image" src="/authors/ryan/avatar_hu2133b973be59ca79693e44e4bc908b85_51876_60x60_fill_q75_box_center.jpg" />
                        </a>
                    </li>
                </ul>
                <div class="article-byline-meta">
                    <h4 class="author-name"><a href="https://ryanjan.uk/authors/ryan/">Ryan Kowalewski</a></h4>
                    <div class="byline-meta-content">
                        13 May 2021
                        <span class="byline-reading-time"><span class="bull">&bull;</span> 4 min
                            read</span>
                    </div>
                </div>
                
                
            </section>
        </div>

        
        <figure class="article-image">
            <img src="/images/2021/05/powershell.jpg" alt="PowerShell Tips: What is splatting and should I use it?" />
        </figure>
        
    </header>

    <section class="gh-content gh-canvas">
        

<h2 id="introduction">Introduction</h2>

<p>In this post I am going to demonstrate a very useful PowerShell technique called splatting. But what is splatting? Here is the official
description from the <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_splatting?view=powershell-7.1">about_Splatting</a>
doc.</p>

<blockquote>
<p>Splatting is a method of passing a collection of parameter values to a command as a unit. PowerShell associates each value in the collection with a command       parameter. Splatted parameter values are stored in named splatting variables, which look like standard variables, but begin with an At symbol (@) instead of a dollar sign ($). The At symbol tells PowerShell that you are passing a collection of values, instead of a single value.</p>

<p>Splatting makes your commands shorter and easier to read. You can reuse the splatting values in different command calls and use splatting to pass parameter values from the $PSBoundParameters automatic variable to other scripts and functions.</p>
</blockquote>

<p>As you can see, splatting is essentially all about code readability. It is a nice way to avoid writing commands with many parameters that end up running way off of your display and causing lots of scrolling around. The description above makes it sound much more complicated than it actually is so lets just dive into some examples.</p>

<h2 id="getting-started">Getting Started</h2>

<p>Take the following command which enables AD authentication on an Azure File Share.</p>

<pre><code class="language-powershell">Set-AzStorageAccount -ResourceGroupName $ResourceGroup -Name $StorAccount -EnableActiveDirectoryDomainServicesForFile $true -ActiveDirectoryDomainName $DomainName -ActiveDirectoryNetBiosDomainName $DomainName -ActiveDirectoryForestName $DomainName -ActiveDirectoryDomainGuid $DomainGuid -ActiveDirectoryDomainsid $DomainSid -ActiveDirectoryAzureStorageSid $StorAccountSid
</code></pre>

<p>This command requires nine parameters, all of which have pretty long names, and means that you cannot see exactly what is going on without scrolling all the way to the right.</p>

<p>This is where splatting comes in. Splatting allows us to write the following instead.</p>

<pre><code class="language-powershell">$Params = @{
    ResourceGroupName = $ResourceGroup
    Name = $StorAccount
    EnableActiveDirectoryDomainServicesForFile = $true
    ActiveDirectoryDomainName = $DomainName
    ActiveDirectoryNetBiosDomainName = $DomainName
    ActiveDirectoryForestName = $DomainName
    ActiveDirectoryDomainGuid = $DomainGuid
    ActiveDirectoryDomainsid = $DomainSid
    ActiveDirectoryAzureStorageSid = $StorAccountSid
}

Set-AzStorageAccount @Params
</code></pre>

<p>As you can see, we are creating a hashtable named <code>$Params</code> containing each parameter and its value. We can then use this hashtable in place of the parameters by specifying it after the command with the <code>@</code> prefix rather than the <code>$</code> variable prefix. This makes the command much more readable and avoids the need to scroll around to see all of the parameters.</p>

<h2 id="reusing-splatted-parameters">Reusing Splatted Parameters</h2>

<p>One of the more functional benefits of splatting is that you can reuse the hashtable containing the parameters multiple times, changing parameters and their values as required.</p>

<p>The following example writes a message to the console, changing some of the parameter values depending on whether the fictional <code>$Results</code> variable contains an Error property.</p>

<pre><code class="language-powershell">$Results = Invoke-SomeCommand

if ($Results.Error) {
    Write-Host -Message &quot;Error&quot; -ForegroundColor &quot;Gray&quot; -BackgroundColor &quot;Red&quot;
} else {
    Write-Host -Message &quot;Hello World!&quot; -ForegroundColor &quot;Gray&quot; -BackgroundColor &quot;Magenta&quot;
}
</code></pre>

<p>Using splatting, we can avoid writing the full command out twice. Instead we can specify the default paramaters and values in the <code>$Params</code> hashtable and simply change the values we require if <code>$Results</code> contains an Error property.</p>

<pre><code class="language-powershell">$Results = Invoke-SomeCommand

$Params = @{
    Message = &quot;Hello world!&quot;
    ForegroundColor = &quot;Gray&quot;
    BackgroundColor = &quot;Magenta&quot;
}

if ($Results.Error) {
    $Params.Message = &quot;Error&quot;
    $Params.BackgroundColor = &quot;Red&quot;
}

Write-Host @Params
</code></pre>

<p>This is not exactly a real world example but it at least shows how you can reuse the parameters in the hashtable. This technique is extremely powerful when used in more complex scripts/functions etc.</p>

<h2 id="mixing-splatting-with-explicitly-defined-parameters">Mixing Splatting with Explicitly Defined Parameters</h2>

<p>It is possible to mix both splatted parameters with explicit parameters. For example.</p>

<pre><code class="language-powershell">$Params = @{
    Parameter1 = &quot;Value1&quot;
    Parameter2 = &quot;Value2&quot;
}
Invoke-SomeCommand @Params -WhatIf
</code></pre>

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-8907477009760148"
     data-ad-slot="3921250676"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

<h2 id="switch-parameter-types">Switch Parameter Types</h2>

<p>One point to mention is how to specify switch parameters when splatting. When specifying a switch parameter directly you simply type the parameter name. For example, when specifying the <code>-WhatIf</code> parameter.</p>

<pre><code class="language-powershell">Invoke-SomeCommand -Parameter1 &quot;Value1&quot; -WhatIf
</code></pre>

<p>However, when using splatting you will need to provide a <code>$true</code> or <code>$false</code> value for the switch paramater in the hashtable. For example.</p>

<pre><code class="language-powershell">$Params = @{
    Parameter1 = &quot;Value1&quot;
    WhatIf = $true
}

Invoke-SomeCommand @Params
</code></pre>

<h2 id="conclusion">Conclusion</h2>

<p>Hopefully this has been an interesting overview of the splatting technique. Splatting is key to writing readable PowerShell code and yet I find that many people I mention it to have never actually heard of it.</p>

<p>There is a great community project on GitHub called <a href="https://poshcode.gitbook.io/powershell-practice-and-style/">PowerShell Practice and Style</a> which aims to lay out some best practices for writing PowerShell code. They make reference to the splatting technique in the <a href="https://poshcode.gitbook.io/powershell-practice-and-style/style-guide/readability">readability</a> section which is where I first stumbled across it.</p>

    </section>

</article>

<section class="footer-cta">
    <div class="inner">
        <h2>Sign up for more like this.</h2>
        <a class="footer-cta-button su-modal-open-button" href="#/subscribe">
            <div>Enter your email</div>
            <span>Subscribe</span>
        </a>
    </div>
</section>

<aside class="read-more-wrap">
    <div class="read-more inner">
        
        
        
        <article class="post-card">

    
    <a class="post-card-image-link" href="https://ryanjan.uk/2019/10/15/add-hard-disks-async-with-powercli/">
        <img class="post-card-image" src="/images/2019/10/wait-image.jpg" loading="lazy" />
    </a>
    

    <div class="post-card-content">
        <a class="post-card-content-link" href="https://ryanjan.uk/2019/10/15/add-hard-disks-async-with-powercli/">
            <header class="post-card-header">
                
                
                
                <div class="post-card-primary-tag">powercli</div>
                
                
                <h2 class="post-card-title">Add Hard Disks to VMs Asynchronously with PowerCLI</h2>
            </header>
            <section class="post-card-excerpt">
                <p>At the time of writing the <code>New-HardDisk</code> PowerCLI CmdLet does not yet have a <code>-RunAsync</code> parameter. I found this out when trying to create a new 300 GiB eagerly zeroed disk on multiple VMs in one go. I soon realised that I was going to be sat there for a long time as each new disk was being formatted one at a time.</p>
            </section>
        </a>

        <footer class="post-card-meta">
            
            
            
            
            
            <ul class="author-list">
                <li class="author-list-item">
                    
                    <a href="https://ryanjan.uk/authors/ryan/" class="static-avatar">
                        
                        <img class="author-profile-image" src="/authors/ryan/avatar_hu2133b973be59ca79693e44e4bc908b85_51876_60x60_fill_q75_box_center.jpg" />
                    </a>
                </li>
            </ul>
            
            <div class="post-card-byline-content">
                
                <a href="https://ryanjan.uk/authors/ryan/">Ryan Kowalewski</a>
                
                <span class="post-card-byline-date">15 Oct 2019 <span class="bull"> &bull; </span>
                    3 min read</span>
            </div>
            
        </footer>
    </div>
</article>
        
        <article class="post-card">

    
    <a class="post-card-image-link" href="https://ryanjan.uk/2019/06/19/vsphere-global-permissions-with-powershell/">
        <img class="post-card-image" src="/images/2019/06/closed-coming-soon-door-4291.jpg" loading="lazy" />
    </a>
    

    <div class="post-card-content">
        <a class="post-card-content-link" href="https://ryanjan.uk/2019/06/19/vsphere-global-permissions-with-powershell/">
            <header class="post-card-header">
                
                
                
                <div class="post-card-primary-tag">powershell</div>
                
                
                <h2 class="post-card-title">Managing vSphere Global Permissions with PowerShell</h2>
            </header>
            <section class="post-card-excerpt">
                <p>It appears that working with vSphere global permissions in PowerCLI is not yet possible. The VIPerms PowerShell module combines the add/remove examples from William&rsquo;s post with a new function to list all global permissions. In this post I will demonstrate how to install and use this module.</p>
            </section>
        </a>

        <footer class="post-card-meta">
            
            
            
            
            
            <ul class="author-list">
                <li class="author-list-item">
                    
                    <a href="https://ryanjan.uk/authors/ryan/" class="static-avatar">
                        
                        <img class="author-profile-image" src="/authors/ryan/avatar_hu2133b973be59ca79693e44e4bc908b85_51876_60x60_fill_q75_box_center.jpg" />
                    </a>
                </li>
            </ul>
            
            <div class="post-card-byline-content">
                
                <a href="https://ryanjan.uk/authors/ryan/">Ryan Kowalewski</a>
                
                <span class="post-card-byline-date">19 Jun 2019 <span class="bull"> &bull; </span>
                    3 min read</span>
            </div>
            
        </footer>
    </div>
</article>
        
        <article class="post-card">

    
    <a class="post-card-image-link" href="https://ryanjan.uk/2019/02/10/get-host-cdp-info-with-powercli/">
        <img class="post-card-image" src="/images/2019/02/cisco-logo-16x9-2-1.jpg" loading="lazy" />
    </a>
    

    <div class="post-card-content">
        <a class="post-card-content-link" href="https://ryanjan.uk/2019/02/10/get-host-cdp-info-with-powercli/">
            <header class="post-card-header">
                
                
                
                <div class="post-card-primary-tag">powercli</div>
                
                
                <h2 class="post-card-title">Get ESXi Host CDP Info With PowerCLI</h2>
            </header>
            <section class="post-card-excerpt">
                <p>I recently had to provide our networking team with a list of ESXi hosts and which switchports each of their physical NICs were connected to. Like many other environments, we are primarily a Cisco house and therefore I was able to get this data by querying the Cisco Discovery Protocol (CDP) information via PowerCLI. Here is how I went about it.</p>
            </section>
        </a>

        <footer class="post-card-meta">
            
            
            
            
            
            <ul class="author-list">
                <li class="author-list-item">
                    
                    <a href="https://ryanjan.uk/authors/ryan/" class="static-avatar">
                        
                        <img class="author-profile-image" src="/authors/ryan/avatar_hu2133b973be59ca79693e44e4bc908b85_51876_60x60_fill_q75_box_center.jpg" />
                    </a>
                </li>
            </ul>
            
            <div class="post-card-byline-content">
                
                <a href="https://ryanjan.uk/authors/ryan/">Ryan Kowalewski</a>
                
                <span class="post-card-byline-date">10 Feb 2019 <span class="bull"> &bull; </span>
                    6 min read</span>
            </div>
            
        </footer>
    </div>
</article>
        
        
    </div>
</aside>

    </main>
    <footer class="site-footer outer">
    <div class="inner">
        <section class="copyright"><a href="https://ryanjan.uk/">Ryan Jan</a> &copy; 2021</section>
        <nav class="site-footer-nav">
            <a href="https://ryanjan.uk/">Latest Posts</a>
            <a href="https://github.com/ryan-jan" target="_blank" rel="noopener">GitHub</a>
            <a href="https://twitter.com/_ryanjan_" target="_blank" rel="noopener">Twitter</a>
        </nav>
    </div>
</footer>
  </div>

  <div id="signup-modal" class="su-modal">
    <div class="su-modal-wrapper">
      <div class="su-modal-container">
        <div class="su-modal-content">
          <span class="su-modal-closeicon">&times;</span>
          <header class="su-modal-signup-header"><img class="su-modal-signup-logo" src="/images/favicon.png"
              alt="RyanJan">
            
          </header>
          <form
            action="https://ryanjan.us1.list-manage.com/subscribe/post?u=60a6496a899e75ef8efe2e2ce&amp;id=9265c5169c"
            method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate"
            target="_blank" novalidate>
            <div class="su-modal-section">
              <section class="su-modal-input-section">
                <div class="su-modal-input-labelcontainer">
                  <label for="input-name" class="su-modal-input-label">Name</label>
                </div>
                <input type="text" value="" name="NAME" class="su-modal-input" id="input-name" placeholder="Joe Bloggs">
              </section>
              <section class="su-modal-input-section">
                <div class="su-modal-input-labelcontainer">
                  <label for="input-email" class="su-modal-input-label">Email</label>
                </div>
                <input type="email" value="" name="EMAIL" class="su-modal-input" id="input-email"
                  placeholder="joe.bloggs@example.com">
              </section>
              
              <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text"
                  name="b_60a6496a899e75ef8efe2e2ce_9265c5169c" tabindex="-1" value=""></div>

              <button class="su-modal-btn su-modal-btn-main su-modal-btn-primary" type="submit"
                style="color: rgb(255, 255, 255); background-color: rgb(0, 0, 0); opacity: 1; pointer-events: auto; width: 100%;">Sign
                up</button>

              <div id="mce-responses" class="clear">
                <div class="response" id="mce-error-response" style="display:none"></div>
                <div class="response" id="mce-success-response" style="display:none"></div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <script type='text/javascript' src='//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js'></script>
  <script
    type='text/javascript'>(function ($) { window.fnames = new Array(); window.ftypes = new Array(); fnames[1] = 'NAME'; ftypes[1] = 'text'; fnames[0] = 'EMAIL'; ftypes[0] = 'email'; }(jQuery)); var $mcj = jQuery.noConflict(true);</script>

  
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous">
    </script>
  <script src="/js/casper.js"></script>
  <script>
    $(document).ready(function () {
      
      $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
      });
      
      $(".gh-content").fitVids();
    });
  </script>

  
  <script type="text/javascript" src="/js/prism.js"></script>
  <script type="text/javascript" src="/js/custom/prism-custom.js"></script>
  <script type="text/javascript" src="/js/custom/custom.js"></script>

  
</body>

</html>