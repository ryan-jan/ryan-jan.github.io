<!DOCTYPE html>
<html>

<head>
  <script>
    if (window.location.hostname !== "localhost") {
      window.location.replace(window.location.href.replace("ryanjan.uk", "cherrypicking.dev"))
    }
  </script>
  
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-58NYGBDL75"></script>
  <script>
    if (window.location.hostname === "localhost") {
      console.log("Analytics not running on local dev.");
    } else {
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-58NYGBDL75');
    }
  </script>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> How to run ESXCLI commands in PowerShell using the PowerCLI Get-EsxCli cmdlet</title>
  <meta name="viewport" content="width=device-width,minimum-scale=1">
  <META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" type="text/css" href="/css/screen.css" />

  
  <link rel="stylesheet" type="text/css" href="/css/custom/screen-custom.css" />
  <link rel="stylesheet" type="text/css" href="/css/fontawesome_all.min.css" />
  <link rel="stylesheet" type="text/css" href="/css/custom/syntax.css" />
  <link rel="stylesheet" type="text/css" href="/css/custom/global-custom.css" />

  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,500,600,700" rel="stylesheet">

  
  <script data-ad-client="ca-pub-8907477009760148" async
    src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  
<meta name="twitter:card" content="summary_large_image">



<meta name="twitter:creator" content="@_ryanjan_">
<meta name="twitter:site" content="@_ryanjan_">

<meta property="og:title" content="How to run ESXCLI commands in PowerShell using the PowerCLI Get-EsxCli cmdlet">
<meta property="og:description" content="If you&rsquo;re a vSphere admin, you&rsquo;ll be very familiar with the esxcli command. But have you ever wondered how to run esxcli commands from PowerCLI? Maybe you don&rsquo;t want to enable SSH on your hosts, or perhaps you need to run an esxcli command in a PowerShell script.">
<meta property="og:url" content="https://ryanjan.uk/how-to-run-esxcli-commands-in-powershell/">

    <meta property="og:image" content="https://ryanjan.uk/how-to-run-esxcli-commands-in-powershell/feature-image.png">


</head>





<body class='post-template' >
  <div class="viewport">
    <header id="gh-head" class="gh-head">
      <nav class="gh-head-inner inner gh-container">

        <div class="gh-head-brand">
          <a class="gh-head-logo" href="/">
            <img src="/images/cp-favicon.png" />
          </a>
          <a class="gh-burger" role="button">
            <div class="gh-burger-box">
              <div class="gh-burger-inner"></div>
            </div>
          </a>
        </div>
        <div class="gh-head-menu">
          <ul class="nav">
    <li class="nav-home nav-current"><a href="/">Home</a></li>
    <li class="nav-about"><a href="/about/">About</a></li>
</ul>
        </div>
        <div class="gh-head-actions">
          <div class="gh-social">
            <a class="gh-social-github" href="https://github.com/ryan-jan" title="GitHub" target="_blank"
              rel="noopener">
              <i class="fab fa-github fa-lg"></i>
            </a>
            <a class="gh-social-twitter" href="https://twitter.com/_ryanjan_" title="Twitter" target="_blank"
              rel="noopener">
              <i class="fab fa-twitter fa-lg"></i>
            </a>
          </div>
          <a class="gh-head-button su-modal-open-button" href="#/subscribe">Subscribe</a>
        </div>
      </nav>
    </header>
    <main>
      
<article class="article">
    <header class="article-header gh-canvas">
        
        
        
        <section class="article-tag">
            <a href="/tags/powercli">powercli</a>
        </section>
        
        

        <h1 class="article-title">How to run ESXCLI commands in PowerShell using the PowerCLI Get-EsxCli cmdlet</h1>

        

        <div class="article-byline">
            <section class="article-byline-content">
                
                
                
                
                
                
                <ul class="author-list">
                    <li class="author-list-item">
                        
                        <a href="https://ryanjan.uk/authors/ryan/" class="author-avatar">
                            
                            <img class="author-profile-image" src="/authors/ryan/avatar_hu2133b973be59ca79693e44e4bc908b85_51876_60x60_fill_q75_box_center.jpg" />
                        </a>
                    </li>
                </ul>
                <div class="article-byline-meta">
                    <h4 class="author-name"><a href="https://ryanjan.uk/authors/ryan/">Ryan Kowalewski</a></h4>
                    <div class="byline-meta-content">
                        17 Jun 2021
                        <span class="byline-reading-time"><span class="bull">&bull;</span> 8 min
                            read</span>
                    </div>
                </div>
                
                
                
            </section>
        </div>

        
        <figure class="article-image">
            <img src="/how-to-run-esxcli-commands-in-powershell/feature-image.png" alt="feature-image.png" />
        </figure>
        
    </header>

    <section class="gh-content gh-canvas">
        <div class="overlay-toc fixed">
    <span class="toc-title">CONTENTS</span>
    <ul id="toc-list"></ul>
</div>
<p>If you&rsquo;re a vSphere admin, you&rsquo;ll be very familiar with the <a href="https://code.vmware.com/docs/13462/esxcli-7-0-u2-concepts-and-examples/GUID-D2EA47F0-E7C2-4918-A07E-7161FB37E073.html"><code>esxcli</code></a> command. But have you ever wondered how to run <code>esxcli</code> commands from <a href="https://developer.vmware.com/powercli">PowerCLI</a>? Maybe you don&rsquo;t want to enable SSH on your hosts, or perhaps you need to run an <code>esxcli</code> command in a PowerShell script. The <a href="https://developer.vmware.com/docs/powercli/latest/vmware.vimautomation.core/commands/get-esxcli/#Default"><code>Get-EsxCli</code></a> cmdlet from the <a href="https://developer.vmware.com/powercli"><code>VMware.PowerCLI</code></a> PowerShell module is the answer!</p>
<p>In this tutorial, you&rsquo;ll learn how to create an <code>esxcli</code> interface to a host using PowerCLI, how to investigate the available namespaces, how to invoke <code>esxcli</code> methods, and more! It&rsquo;ll give you all the information you need to get the most out of the <code>Get-EsxCli</code> cmdlet.</p>
<div class="in-article-ad">
     <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
     <ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article"
          data-ad-format="fluid" data-ad-client="ca-pub-8907477009760148" data-ad-slot="3921250676"></ins>
     <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
     </script>
</div>
<h2 id="prerequisites">Prerequisites</h2>
<p>To follow along with this tutorial, you&rsquo;ll need the following:</p>
<ul>
<li>PowerShell 5.1 or later. This tutorial will use PowerShell 7.1 on a Windows 10 workstation.</li>
<li>VMware.PowerCLI version 12.3 or later (For instructions on how to install PowerCLI, see <a href="https://developer.vmware.com/powercli/installation-guide">this VMware guide</a>).</li>
<li>A vCenter server with at least one managed ESXi host. Both the server and host should be running version 6.5 or later.</li>
<li>A general working knowledge of the <code>esxcli</code> command.</li>
</ul>
<h2 id="creating-an-interface-to-esxcli-using-get-esxcli">Creating an interface to ESXCLI using Get-EsxCli</h2>
<p>The first step is to create an interface to an ESXi host using the <code>Get-EsxCli</code> cmdlet. This interface information is stored in a variable, which is then used to invoke <code>esxcli</code> methods.</p>
<p>The following commands will connect you to your vCenter server and store the <code>esxcli</code> interface in a variable (<code>$EsxCli</code>).</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e5c07b">Connect-ViServer</span> <span style="color:#e06c75">-Server</span> <span style="color:#98c379">&#34;vcenter.example.com&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">$EsxCli</span> = <span style="color:#e5c07b">Get-EsxCli</span> <span style="color:#e06c75">-VMHost</span> <span style="color:#98c379">&#34;esx01.example.com&#34;</span> <span style="color:#e06c75">-V2</span>
</span></span></code></pre></div><div class="callout info">
    <div class="callout-wrapper">
        <span>
            
            <i class="fas fa-info-circle fa-lg"></i>
            
        </span>
        <div class="callout-content">
            <p>You need the <code>V2</code> switch parameter to use the latest interface version 2. VMware has deprecated interface version 1.</p>
        </div>
    </div>
</div>
<div class="in-article-ad">
     <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
     <ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article"
          data-ad-format="fluid" data-ad-client="ca-pub-8907477009760148" data-ad-slot="3921250676"></ins>
     <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
     </script>
</div>
<h2 id="traversing-the-namespace-hierarchy">Traversing the namespace hierarchy</h2>
<p>With the <code>esxcli</code> interface details now stored in <code>$EsxCli</code>, it&rsquo;s time to look around. To start with, you can simply call the <code>$EsxCli</code> object to view all root namespace elements; for example:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e06c75">$EsxCli</span>
</span></span></code></pre></div><div class="code-title-bar"><span>Output</span></div>
<div class="code-inner">
    <div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e5c07b">PS </span><span style="color:#e06c75">C:</span>\&gt; <span style="color:#e06c75">$EsxCli</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>===============================
</span></span><span style="display:flex;"><span><span style="color:#e06c75">EsxCli</span>: <span style="color:#e06c75">esx01</span>.<span style="color:#e06c75">example</span>.<span style="color:#e06c75">com</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">Elements</span>:
</span></span><span style="display:flex;"><span>   ---------
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">device</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">elxnet</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">esxcli</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">fcoe</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">graphics</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">hardware</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">iscsi</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">network</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">nvme</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">rdma</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">sched</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">software</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">storage</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">system</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">vm</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">vsan</span>
</span></span></code></pre></div>
</div>

<div class="code-caption">
    <span>Output showing the available root namespace elements.</span>
</div>

<p>Then, using dot (<code>.</code>) notation, you can traverse the namespace hierarchy to see all available namespaces. For example, to see the namespaces available in the <code>software</code> root namespace, you can do the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>
</span></span></code></pre></div><div class="code-title-bar"><span>Output</span></div>
<div class="code-inner">
    <div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e5c07b">PS </span><span style="color:#e06c75">C:</span>\&gt; <span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>=======================
</span></span><span style="display:flex;"><span><span style="color:#e06c75">EsxCliElement</span>: <span style="color:#e06c75">software</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">Elements</span>:
</span></span><span style="display:flex;"><span>   ---------
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">acceptance</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">profile</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">sources</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">vib</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">Methods</span>:
</span></span><span style="display:flex;"><span>   --------
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">string</span> <span style="color:#e06c75">Help</span>()
</span></span></code></pre></div>
</div>

<div class="code-caption">
    <span>Output showing the namespaces available in the `esxcli software` root namespace.</span>
</div>

<h2 id="running-esxcli-commands">Running esxcli commands</h2>
<p>As you look at the different namespaces, you&rsquo;ll start to see Method Elements and Methods listed in the output. For example, if you call the <code>$EsxCli.software.vib</code> namespace element, you&rsquo;ll see the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>
</span></span></code></pre></div><div class="code-title-bar"><span>Output</span></div>
<div class="code-inner">
    <div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e5c07b">PS </span><span style="color:#e06c75">C:</span>\&gt; <span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>==================
</span></span><span style="display:flex;"><span><span style="color:#e06c75">EsxCliElement</span>: <span style="color:#e06c75">vib</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">Elements</span>:
</span></span><span style="display:flex;"><span>   ---------
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">signature</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">Method</span> <span style="color:#e06c75">Elements</span>:
</span></span><span style="display:flex;"><span>   ---------
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">get</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">install</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">list</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">remove</span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">update</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">Methods</span>:
</span></span><span style="display:flex;"><span>   --------
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">string</span> <span style="color:#e06c75">Help</span>()
</span></span></code></pre></div>
</div>

<div class="code-caption">
    <span>Output showing available Methods and Method Elements for `esxcli software vib`.</span>
</div>

<h3 id="method-elements-vs-methods">Method Elements vs Methods</h3>
<p>Method Elements refer to PowerShell objects that represent an available <code>esxcli</code> command, whereas Methods are the functions you can execute. Method Element objects contain multiple Methods, as you&rsquo;ll see later.</p>
<p>For example, you can execute the <code>$EsxCli.software.vib.Help()</code> Method directly and it will display some useful information, as shown below.</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">Help</span>()
</span></span></code></pre></div><div class="code-title-bar"><span>Output</span></div>
<div class="code-inner">
    <div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e5c07b">PS </span><span style="color:#e06c75">C:</span>\&gt; <span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">Help</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>================================================================================================================================================================================================================
</span></span><span style="display:flex;"><span><span style="color:#e06c75">vim</span>.<span style="color:#e06c75">EsxCLI</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>
</span></span><span style="display:flex;"><span>----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Install</span>, <span style="color:#e06c75">update</span>, <span style="color:#e06c75">remove</span>, <span style="color:#e06c75">or</span> <span style="color:#e06c75">display</span> <span style="color:#e06c75">individual</span> <span style="color:#e06c75">VIB</span> <span style="color:#e06c75">packages</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">ChildElement</span>
</span></span><span style="display:flex;"><span>----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
</span></span><span style="display:flex;"><span>- <span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">signa</span> | <span style="color:#e06c75">Commands</span> <span style="color:#e06c75">to</span> <span style="color:#e06c75">verify</span> <span style="color:#e06c75">signatures</span> <span style="color:#e06c75">and</span> <span style="color:#e06c75">show</span> <span style="color:#e06c75">information</span> <span style="color:#e06c75">about</span> <span style="color:#e06c75">the</span> <span style="color:#e06c75">signature</span> <span style="color:#e06c75">verification</span> <span style="color:#e06c75">status</span> <span style="color:#e06c75">of</span> <span style="color:#e06c75">VIB</span> <span style="color:#e06c75">packages</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e06c75">ture</span>               |
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Method</span>
</span></span><span style="display:flex;"><span>----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
</span></span><span style="display:flex;"><span>- <span style="color:#e06c75">get</span>                | <span style="color:#e06c75">Displays</span> <span style="color:#e06c75">detailed</span> <span style="color:#e06c75">information</span> <span style="color:#e06c75">about</span> <span style="color:#e06c75">one</span> <span style="color:#e06c75">or</span> <span style="color:#e06c75">more</span> <span style="color:#e06c75">installed</span> <span style="color:#e06c75">VIBs</span>
</span></span><span style="display:flex;"><span>- <span style="color:#e06c75">install</span>            | <span style="color:#e06c75">Installs</span> <span style="color:#e06c75">VIB</span> <span style="color:#e06c75">packages</span> <span style="color:#e06c75">from</span> <span style="color:#e06c75">a</span> <span style="color:#e06c75">URL</span> <span style="color:#e06c75">or</span> <span style="color:#e06c75">depot</span>. <span style="color:#e06c75">VIBs</span> <span style="color:#e06c75">may</span> <span style="color:#e06c75">be</span> <span style="color:#e06c75">installed</span>, <span style="color:#e06c75">upgraded</span>, <span style="color:#e06c75">or</span> <span style="color:#e06c75">downgraded</span>. <span style="color:#e06c75">WARNING</span>: <span style="color:#c678dd">If</span> <span style="color:#e06c75">your</span> <span style="color:#e06c75">installation</span> <span style="color:#e06c75">requires</span> <span style="color:#e06c75">a</span> <span style="color:#e06c75">reboot</span>, <span style="color:#e06c75">you</span> <span style="color:#e06c75">need</span> <span style="color:#e06c75">to</span> <span style="color:#e06c75">disable</span> <span style="color:#e06c75">HA</span> <span style="color:#e06c75">first</span>.
</span></span><span style="display:flex;"><span>- <span style="color:#e06c75">list</span>               | <span style="color:#e06c75">Lists</span> <span style="color:#e06c75">the</span> <span style="color:#e06c75">installed</span> <span style="color:#e06c75">VIB</span> <span style="color:#e06c75">packages</span>
</span></span><span style="display:flex;"><span>- <span style="color:#e06c75">remove</span>             | <span style="color:#e06c75">Removes</span> <span style="color:#e06c75">VIB</span> <span style="color:#e06c75">packages</span> <span style="color:#e06c75">from</span> <span style="color:#e06c75">the</span> <span style="color:#e06c75">host</span>. <span style="color:#e06c75">WARNING</span>: <span style="color:#c678dd">If</span> <span style="color:#e06c75">your</span> <span style="color:#e06c75">installation</span> <span style="color:#e06c75">requires</span> <span style="color:#e06c75">a</span> <span style="color:#e06c75">reboot</span>, <span style="color:#e06c75">you</span> <span style="color:#e06c75">need</span> <span style="color:#e06c75">to</span> <span style="color:#e06c75">disable</span> <span style="color:#e06c75">HA</span> <span style="color:#e06c75">first</span>.
</span></span><span style="display:flex;"><span>- <span style="color:#e06c75">update</span>             | <span style="color:#e06c75">Update</span> <span style="color:#e06c75">installed</span> <span style="color:#e06c75">VIBs</span> <span style="color:#e06c75">to</span> <span style="color:#e06c75">newer</span> <span style="color:#e06c75">VIB</span> <span style="color:#e06c75">packages</span>. <span style="color:#e06c75">No</span> <span style="color:#e06c75">new</span> <span style="color:#e06c75">VIBs</span> <span style="color:#e06c75">will</span> <span style="color:#e06c75">be</span> <span style="color:#e06c75">installed</span>, <span style="color:#e06c75">only</span> <span style="color:#e06c75">updates</span>. <span style="color:#e06c75">WARNING</span>: <span style="color:#c678dd">If</span> <span style="color:#e06c75">your</span> <span style="color:#e06c75">installation</span> <span style="color:#e06c75">requires</span> <span style="color:#e06c75">a</span> <span style="color:#e06c75">reboot</span>, <span style="color:#e06c75">you</span> <span style="color:#e06c75">need</span> <span style="color:#e06c75">to</span> <span style="color:#e06c75">disable</span> <span style="color:#e06c75">HA</span> <span style="color:#e06c75">first</span>.
</span></span></code></pre></div>
</div>

<div class="code-caption">
    <span>Output showing `Help()` information for `esxcli software vib`</span>
</div>

<p>But, if you try and call the <code>get</code> Method Element directly, you&rsquo;ll get an error; for example:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">get</span>()
</span></span></code></pre></div><div class="code-title-bar"><span>Output</span></div>
<div class="code-inner">
    <div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e5c07b">PS </span><span style="color:#e06c75">C:</span>\&gt; <span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">get</span>()
</span></span><span style="display:flex;"><span><span style="color:#7f848e">#error</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">InvalidOperation</span>: <span style="color:#e06c75">Method</span> <span style="color:#e06c75">invocation</span> <span style="color:#e06c75">failed</span> <span style="color:#e06c75">because</span> [<span style="color:#e06c75">VMware.VimAutomation.ViCore.Impl.V1.EsxCli.EsxCliElementImpl</span>] <span style="color:#e06c75">does</span> <span style="color:#e06c75">not</span> <span style="color:#e06c75">contain</span> <span style="color:#e06c75">a</span> <span style="color:#e06c75">method</span> <span style="color:#e06c75">named</span> <span style="color:#98c379">&#39;get&#39;</span>.
</span></span><span style="display:flex;"><span><span style="color:#7f848e">#enderror</span>
</span></span></code></pre></div>
</div>

<div class="code-caption">
    <span>Output showing error when calling a Method Element directly.</span>
</div>

<div class="in-article-ad">
     <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
     <ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article"
          data-ad-format="fluid" data-ad-client="ca-pub-8907477009760148" data-ad-slot="3921250676"></ins>
     <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
     </script>
</div>
<h3 id="using-the-invoke-method">Using the <code>Invoke()</code> Method</h3>
<p>Now that you know the difference between Method Elements and Methods, it&rsquo;s time to start running some <code>esxcli</code> commands.</p>
<p>First, print the <code>$EsxCli.software.vib.get</code> object to the console using the following command. You&rsquo;ll see that it contains its own list of callable Methods.</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">get</span>
</span></span></code></pre></div><div class="code-title-bar"><span>Output</span></div>
<div class="code-inner">
    <div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e5c07b">PS </span><span style="color:#e06c75">C:</span>\&gt; <span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">get</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>==================
</span></span><span style="display:flex;"><span><span style="color:#e06c75">EsxCliMethodElement</span>: <span style="color:#e06c75">get</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">Methods</span>:
</span></span><span style="display:flex;"><span>   --------
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">Hashtable</span> <span style="color:#e06c75">CreateArgs</span>()
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">VIB</span>[] <span style="color:#e06c75">Invoke</span>(<span style="color:#e06c75">Hashtable</span> <span style="color:#e06c75">args</span>)
</span></span><span style="display:flex;"><span>   <span style="color:#e06c75">string</span> <span style="color:#e06c75">Help</span>()
</span></span></code></pre></div>
</div>

<div class="code-caption">
    <span>Output showing the available Methods within the `esxcli software vib get` Method Element.</span>
</div>

<p>You can use the <code>Invoke()</code> Method to run the <code>esxcli software vib get</code> command; for example:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">get</span>.<span style="color:#e06c75">Invoke</span>()
</span></span></code></pre></div><div class="code-title-bar"><span>Output</span></div>
<div class="code-inner">
    <div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e5c07b">PS </span><span style="color:#e06c75">C:</span>\&gt; <span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">get</span>.<span style="color:#e06c75">Invoke</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">AcceptanceLevel</span>           : <span style="color:#e06c75">VMwareCertified</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Conflicts</span>                 :
</span></span><span style="display:flex;"><span><span style="color:#e06c75">CreationDate</span>              : <span style="color:#d19a66">2016</span>-<span style="color:#d19a66">01</span>-<span style="color:#d19a66">06</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Depends</span>                   : {<span style="color:#e06c75">vmkapi_2_3_0_0</span>, <span style="color:#e06c75">com</span>.<span style="color:#e06c75">vmware</span>.<span style="color:#e06c75">driverAPI</span>-<span style="color:#d19a66">9.2</span>.<span style="color:#e06c75">3</span>.<span style="color:#d19a66">0</span>}
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Description</span>               : <span style="color:#e06c75">Adaptec</span> <span style="color:#e06c75">HBA</span> <span style="color:#e06c75">Driver</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">HardwarePlatformsRequired</span> :
</span></span><span style="display:flex;"><span><span style="color:#e06c75">ID</span>                        : <span style="color:#e5c07b">Adaptec_Inc_bootbank_scsi-aacraid_6</span>.<span style="color:#e06c75">0</span>.<span style="color:#e06c75">6</span>.<span style="color:#e06c75">2</span>.<span style="color:#e06c75">1</span>.<span style="color:#d19a66">52011</span>-<span style="color:#e06c75">1OEM</span>.<span style="color:#e06c75">600</span>.<span style="color:#e06c75">0</span>.<span style="color:#e06c75">0</span>.<span style="color:#e06c75">2494585</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">InstallDate</span>               : <span style="color:#d19a66">2020</span>-<span style="color:#d19a66">01</span>-<span style="color:#d19a66">07</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">LiveInstallAllowed</span>        : <span style="color:#e06c75">False</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">LiveRemoveAllowed</span>         : <span style="color:#e06c75">False</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">MaintenanceModeRequired</span>   : <span style="color:#e06c75">True</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Name</span>                      : <span style="color:#e5c07b">scsi-aacraid</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Overlay</span>                   : <span style="color:#e06c75">False</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Payloads</span>                  : {<span style="color:#e5c07b">scsi-aac</span>}
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Provides</span>                  :
</span></span><span style="display:flex;"><span><span style="color:#e06c75">ReferenceURLs</span>             :
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Replaces</span>                  :
</span></span><span style="display:flex;"><span><span style="color:#e06c75">StatelessReady</span>            : <span style="color:#e06c75">False</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Status</span>                    :
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Summary</span>                   : <span style="color:#e06c75">aacraid</span>: <span style="color:#e06c75">scsi</span> <span style="color:#e06c75">driver</span> <span style="color:#c678dd">for</span> <span style="color:#e06c75">VMware</span> <span style="color:#e06c75">ESX</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Tags</span>                      : {<span style="color:#e06c75">driver</span>, <span style="color:#e06c75">module</span>}
</span></span><span style="display:flex;"><span><span style="color:#e5c07b">Type </span>                     : <span style="color:#e06c75">bootbank</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Vendor</span>                    : <span style="color:#e06c75">Adaptec_Inc</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Version</span>                   : <span style="color:#d19a66">6.0</span>.<span style="color:#e06c75">6</span>.<span style="color:#e06c75">2</span>.<span style="color:#e06c75">1</span>.<span style="color:#d19a66">52011</span>-<span style="color:#e06c75">1OEM</span>.<span style="color:#e06c75">600</span>.<span style="color:#e06c75">0</span>.<span style="color:#e06c75">0</span>.<span style="color:#e06c75">2494585</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">AcceptanceLevel</span>           : <span style="color:#e06c75">VMwareCertified</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Conflicts</span>                 :
</span></span><span style="display:flex;"><span><span style="color:#e06c75">CreationDate</span>              : <span style="color:#d19a66">2019</span>-<span style="color:#d19a66">06</span>-<span style="color:#d19a66">30</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Depends</span>                   : {<span style="color:#e06c75">vmkapi_2_5_0_0</span>}
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Description</span>               : <span style="color:#e06c75">Broadcom</span> <span style="color:#e5c07b">NetXtreme-E</span> <span style="color:#e06c75">VMKAPI</span> <span style="color:#e06c75">network</span> <span style="color:#e06c75">driver</span> <span style="color:#c678dd">for</span> <span style="color:#e06c75">VMware</span> <span style="color:#e06c75">ESXi</span>
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div>
</div>

<div class="code-caption">
    <span>Partial output showing list of vibs returned from the `esxcli software vib get` command.</span>
</div>

<h2 id="providing-arguments-to-an-esxcli-command">Providing arguments to an esxcli command</h2>
<p>Now that you have learned how to use the <code>Invoke()</code> method to run an <code>esxcli</code> command in PowerCLI, the next step is to look at how to provide arguments.</p>
<h3 id="identifying-the-available-arguments">Identifying the available arguments</h3>
<p>How do you know which arguments an <code>esxcli</code> command accepts? Thankfully, there are two easy ways to list the available arguments, both of which are available in the <code>$EsxCli.software.vib.get</code> object:</p>
<ol>
<li>
<p>You can use the <code>Help()</code> method. The <code>Help()</code> method prints detailed information on the specific command to the console. For example, you can run <code>$EsxCli.software.vib.get.Help()</code> to print information relating to the <code>esxcli software vib get</code> command, as shown below.</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">get</span>.<span style="color:#e06c75">Help</span>()
</span></span></code></pre></div><div class="code-title-bar"><span>Output</span></div>
<div class="code-inner">
    <div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e5c07b">PS </span><span style="color:#e06c75">C:</span>\&gt; <span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">get</span>.<span style="color:#e06c75">Help</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>================================================================================================================================================================================================================
</span></span><span style="display:flex;"><span><span style="color:#e06c75">vim</span>.<span style="color:#e06c75">EsxCLI</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">get</span>
</span></span><span style="display:flex;"><span>----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Displays</span> <span style="color:#e06c75">detailed</span> <span style="color:#e06c75">information</span> <span style="color:#e06c75">about</span> <span style="color:#e06c75">one</span> <span style="color:#e06c75">or</span> <span style="color:#e06c75">more</span> <span style="color:#e06c75">installed</span> <span style="color:#e06c75">VIBs</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#c678dd">Param</span>
</span></span><span style="display:flex;"><span>----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
</span></span><span style="display:flex;"><span>- <span style="color:#e5c07b">rebooting-image</span>    | <span style="color:#e06c75">Displays</span> <span style="color:#e06c75">either</span> <span style="color:#e06c75">information</span> <span style="color:#c678dd">for</span> <span style="color:#e06c75">the</span> <span style="color:#e06c75">ESXi</span> <span style="color:#e06c75">image</span> <span style="color:#e06c75">that</span> <span style="color:#e06c75">becomes</span> <span style="color:#e06c75">active</span> <span style="color:#e06c75">after</span> <span style="color:#e06c75">a</span> <span style="color:#e06c75">reboot</span>, <span style="color:#e06c75">or</span> <span style="color:#e06c75">nothing</span> <span style="color:#c678dd">if</span> <span style="color:#e06c75">the</span> <span style="color:#e5c07b">pending-reboot</span> <span style="color:#e06c75">image</span> <span style="color:#e06c75">has</span> <span style="color:#e06c75">not</span> <span style="color:#e06c75">been</span> <span style="color:#e06c75">created</span> <span style="color:#e06c75">yet</span>. <span style="color:#c678dd">If</span> <span style="color:#e06c75">not</span> <span style="color:#e06c75">specified</span>, <span style="color:#e06c75">information</span> <span style="color:#e06c75">from</span> <span style="color:#e06c75">the</span> <span style="color:#e06c75">curr</span>
</span></span><span style="display:flex;"><span>                        | <span style="color:#e06c75">ent</span> <span style="color:#e06c75">ESXi</span> <span style="color:#e06c75">image</span> <span style="color:#c678dd">in</span> <span style="color:#e06c75">memory</span> <span style="color:#e06c75">is</span> <span style="color:#e06c75">returned</span>.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>- <span style="color:#e06c75">vibname</span>            | <span style="color:#e06c75">Specifies</span> <span style="color:#e06c75">one</span> <span style="color:#e06c75">or</span> <span style="color:#e06c75">more</span> <span style="color:#e06c75">installed</span> <span style="color:#e06c75">VIBs</span> <span style="color:#e06c75">about</span> <span style="color:#e06c75">which</span> <span style="color:#e06c75">further</span> <span style="color:#e06c75">information</span> <span style="color:#e06c75">is</span> <span style="color:#e06c75">displayed</span>. <span style="color:#c678dd">If</span> <span style="color:#e06c75">this</span> <span style="color:#e06c75">option</span> <span style="color:#e06c75">is</span> <span style="color:#e06c75">not</span> <span style="color:#e06c75">specified</span>, <span style="color:#e06c75">then</span> <span style="color:#e06c75">more</span> <span style="color:#e06c75">information</span> <span style="color:#e06c75">on</span> <span style="color:#e06c75">all</span> <span style="color:#e06c75">the</span> <span style="color:#e06c75">installed</span> <span style="color:#e06c75">VIBs</span> <span style="color:#e06c75">will</span> <span style="color:#e06c75">be</span> <span style="color:#e06c75">displayed</span>. <span style="color:#e06c75">Must</span> <span style="color:#e06c75">be</span> <span style="color:#e06c75">one</span> <span style="color:#e06c75">of</span> <span style="color:#e06c75">the</span> <span style="color:#e06c75">following</span> <span style="color:#e06c75">f</span>
</span></span><span style="display:flex;"><span>                        | <span style="color:#e06c75">orms</span>: <span style="color:#e06c75">name</span>, <span style="color:#e06c75">name</span>:<span style="color:#e06c75">version</span>, <span style="color:#e06c75">vendor</span>:<span style="color:#e06c75">name</span>, <span style="color:#e06c75">or</span> <span style="color:#e06c75">vendor</span>:<span style="color:#e06c75">name</span>:<span style="color:#e06c75">version</span>.
</span></span></code></pre></div>
</div>

<div class="code-caption">
    <span>Output showing the `Help()` info for the `esxcli software vib get` command.</span>
</div>

</li>
<li>
<p>You can use the <code>CreateArgs()</code> helper method. The <code>CreateArgs()</code> method returns an object containing every available argument. You can run the <code>CreateArgs()</code> method, store the resulting object in a variable, and then print the object to the console to see the available arguments, as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#7f848e"># Run the CreateArgs() method and store the returned object in $ArgsObj.</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">$ArgsObj</span> = <span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">get</span>.<span style="color:#e06c75">CreateArgs</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e"># Write the $ArgsObj to the console to view the available arguments.</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">$ArgsObj</span>
</span></span></code></pre></div><div class="code-title-bar"><span>Output</span></div>
<div class="code-inner">
    <div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e5c07b">PS </span><span style="color:#e06c75">C:</span>\&gt; <span style="color:#e06c75">$ArgsObj</span> = <span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">get</span>.<span style="color:#e06c75">CreateArgs</span>()
</span></span><span style="display:flex;"><span><span style="color:#e5c07b">PS </span><span style="color:#e06c75">C:</span>\&gt; <span style="color:#e06c75">$ArgsObj</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Name</span>                           <span style="color:#e06c75">Value</span>
</span></span><span style="display:flex;"><span>----                           -----
</span></span><span style="display:flex;"><span><span style="color:#e06c75">vibname</span>                        <span style="color:#e06c75">Unset</span>, ([<span style="color:#e06c75">string[]</span>], <span style="color:#e06c75">optional</span>)
</span></span><span style="display:flex;"><span><span style="color:#e06c75">rebootingimage</span>                 <span style="color:#e06c75">Unset</span>, ([<span style="color:#e06c75">boolean</span>], <span style="color:#e06c75">optional</span>)
</span></span></code></pre></div>
</div>

<div class="code-caption">
    <span>Output showing the `CreateArgs()` object for the `esxcli software vib get` command.</span>
</div>

</li>
</ol>
<div class="in-article-ad">
     <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
     <ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article"
          data-ad-format="fluid" data-ad-client="ca-pub-8907477009760148" data-ad-slot="3921250676"></ins>
     <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
     </script>
</div>
<h3 id="supplying-arguments-to-the-invoke-method">Supplying arguments to the <code>Invoke()</code> method</h3>
<p>Now you&rsquo;ll learn how to supply the available arguments to the <code>Invoke()</code> method of an <code>esxcli</code> command. There are two different ways to do this:</p>
<ol>
<li>
<p>You can supply the arguments/values as an inline hashtable. For example, to set the <code>vibname</code> argument to the value <code>tools-light</code>, you can do the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">get</span>.<span style="color:#e06c75">Invoke</span>(<span style="color:#e06c75">@</span>{<span style="color:#e06c75">vibname</span> = <span style="color:#98c379">&#34;tools-light&#34;</span>})
</span></span></code></pre></div><div class="code-title-bar"><span>Output</span></div>
<div class="code-inner">
    <div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e5c07b">PS </span><span style="color:#e06c75">C:</span>\&gt; <span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">get</span>.<span style="color:#e06c75">Invoke</span>(<span style="color:#e06c75">@</span>{<span style="color:#e06c75">vibname</span> = <span style="color:#98c379">&#34;tools-light&#34;</span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">AcceptanceLevel</span>           : <span style="color:#e06c75">VMwareCertified</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Conflicts</span>                 :
</span></span><span style="display:flex;"><span><span style="color:#e06c75">CreationDate</span>              : <span style="color:#d19a66">2020</span>-<span style="color:#d19a66">08</span>-<span style="color:#d19a66">06</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Depends</span>                   : {<span style="color:#e5c07b">esx-version</span> &gt;= <span style="color:#d19a66">6.6</span>.<span style="color:#d19a66">0</span>}
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Description</span>               : <span style="color:#e06c75">This</span> <span style="color:#e06c75">package</span> <span style="color:#e06c75">contains</span> <span style="color:#e06c75">cdrom</span> <span style="color:#e06c75">and</span> <span style="color:#e06c75">floppy</span> <span style="color:#e06c75">images</span> <span style="color:#e06c75">used</span> <span style="color:#e06c75">to</span> <span style="color:#e06c75">install</span> <span style="color:#e06c75">the</span> <span style="color:#e06c75">VMware</span> <span style="color:#e06c75">Tools</span> <span style="color:#e06c75">inside</span> <span style="color:#e06c75">virtual</span> <span style="color:#e06c75">machines</span>.
</span></span><span style="display:flex;"><span><span style="color:#e06c75">HardwarePlatformsRequired</span> :
</span></span><span style="display:flex;"><span><span style="color:#e06c75">ID</span>                        : <span style="color:#e5c07b">VMware_locker_tools-light_11</span>.<span style="color:#e06c75">1</span>.<span style="color:#e06c75">1</span>.<span style="color:#d19a66">16303738</span>-<span style="color:#d19a66">16701467</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">InstallDate</span>               : <span style="color:#d19a66">2021</span>-<span style="color:#d19a66">01</span>-<span style="color:#d19a66">11</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">LiveInstallAllowed</span>        : <span style="color:#e06c75">True</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">LiveRemoveAllowed</span>         : <span style="color:#e06c75">True</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">MaintenanceModeRequired</span>   : <span style="color:#e06c75">False</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Name</span>                      : <span style="color:#e5c07b">tools-light</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Overlay</span>                   : <span style="color:#e06c75">False</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Payloads</span>                  : {<span style="color:#e06c75">tools</span>}
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Provides</span>                  :
</span></span><span style="display:flex;"><span><span style="color:#e06c75">ReferenceURLs</span>             :
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Replaces</span>                  :
</span></span><span style="display:flex;"><span><span style="color:#e06c75">StatelessReady</span>            : <span style="color:#e06c75">True</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Status</span>                    :
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Summary</span>                   : <span style="color:#e06c75">VMware</span> <span style="color:#e06c75">Tools</span> <span style="color:#e06c75">VIB</span> <span style="color:#c678dd">for</span> <span style="color:#e06c75">Windows</span> <span style="color:#e06c75">and</span> <span style="color:#e06c75">Linux</span> <span style="color:#e06c75">guests</span> (<span style="color:#e06c75">generated</span> <span style="color:#e06c75">by</span> <span style="color:#e06c75">ESXi</span> <span style="color:#e06c75">server</span> <span style="color:#e06c75">build</span> <span style="color:#d19a66">16701467</span>)
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Tags</span>                      :
</span></span><span style="display:flex;"><span><span style="color:#e5c07b">Type </span>                     : <span style="color:#e06c75">locker</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Vendor</span>                    : <span style="color:#e06c75">VMware</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Version</span>                   : <span style="color:#d19a66">11.1</span>.<span style="color:#e06c75">1</span>.<span style="color:#d19a66">16303738</span>-<span style="color:#d19a66">16701467</span>
</span></span></code></pre></div>
</div>

<div class="code-caption">
    <span>Supplying arguments to the `Invoke()` method using an inline hashtable.</span>
</div>

</li>
<li>
<p>You can use the object created by the <code>CreateArgs()</code> method. To use the same example again, you can set the <code>vibname</code> argument to the value <code>tools-light</code> , as follows.</p>
<div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#7f848e"># Run the CreateArgs() method and store the returned object in $ArgsObj.</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">$ArgsObj</span> = <span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">get</span>.<span style="color:#e06c75">CreateArgs</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e"># Set the vibname property to &#34;tools-light&#34;.</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">$ArgsObj</span>.<span style="color:#e06c75">vibname</span> = <span style="color:#98c379">&#34;tools-light&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#7f848e"># Supply the $ArgsObj object to the Invoke() method.</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">get</span>.<span style="color:#e06c75">Invoke</span>(<span style="color:#e06c75">$ArgsObj</span>)
</span></span></code></pre></div><div class="code-title-bar"><span>Output</span></div>
<div class="code-inner">
    <div class="highlight"><pre tabindex="0" style="color:#abb2bf;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-powershell" data-lang="powershell"><span style="display:flex;"><span><span style="color:#e5c07b">PS </span><span style="color:#e06c75">C:</span>\&gt; <span style="color:#e06c75">$ArgsObj</span> = <span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">get</span>.<span style="color:#e06c75">CreateArgs</span>()
</span></span><span style="display:flex;"><span><span style="color:#e5c07b">PS </span><span style="color:#e06c75">C:</span>\&gt; <span style="color:#e06c75">$ArgsObj</span>.<span style="color:#e06c75">vibname</span> = <span style="color:#98c379">&#34;tools-light&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#e5c07b">PS </span><span style="color:#e06c75">C:</span>\&gt; <span style="color:#e06c75">$EsxCli</span>.<span style="color:#e06c75">software</span>.<span style="color:#e06c75">vib</span>.<span style="color:#e06c75">get</span>.<span style="color:#e06c75">Invoke</span>(<span style="color:#e06c75">$ArgsObj</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">AcceptanceLevel</span>           : <span style="color:#e06c75">VMwareCertified</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Conflicts</span>                 :
</span></span><span style="display:flex;"><span><span style="color:#e06c75">CreationDate</span>              : <span style="color:#d19a66">2020</span>-<span style="color:#d19a66">08</span>-<span style="color:#d19a66">06</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Depends</span>                   : {<span style="color:#e5c07b">esx-version</span> &gt;= <span style="color:#d19a66">6.6</span>.<span style="color:#d19a66">0</span>}
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Description</span>               : <span style="color:#e06c75">This</span> <span style="color:#e06c75">package</span> <span style="color:#e06c75">contains</span> <span style="color:#e06c75">cdrom</span> <span style="color:#e06c75">and</span> <span style="color:#e06c75">floppy</span> <span style="color:#e06c75">images</span> <span style="color:#e06c75">used</span> <span style="color:#e06c75">to</span> <span style="color:#e06c75">install</span> <span style="color:#e06c75">the</span> <span style="color:#e06c75">VMware</span> <span style="color:#e06c75">Tools</span> <span style="color:#e06c75">inside</span> <span style="color:#e06c75">virtual</span> <span style="color:#e06c75">machines</span>.
</span></span><span style="display:flex;"><span><span style="color:#e06c75">HardwarePlatformsRequired</span> :
</span></span><span style="display:flex;"><span><span style="color:#e06c75">ID</span>                        : <span style="color:#e5c07b">VMware_locker_tools-light_11</span>.<span style="color:#e06c75">1</span>.<span style="color:#e06c75">1</span>.<span style="color:#d19a66">16303738</span>-<span style="color:#d19a66">16701467</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">InstallDate</span>               : <span style="color:#d19a66">2021</span>-<span style="color:#d19a66">01</span>-<span style="color:#d19a66">11</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">LiveInstallAllowed</span>        : <span style="color:#e06c75">True</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">LiveRemoveAllowed</span>         : <span style="color:#e06c75">True</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">MaintenanceModeRequired</span>   : <span style="color:#e06c75">False</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Name</span>                      : <span style="color:#e5c07b">tools-light</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Overlay</span>                   : <span style="color:#e06c75">False</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Payloads</span>                  : {<span style="color:#e06c75">tools</span>}
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Provides</span>                  :
</span></span><span style="display:flex;"><span><span style="color:#e06c75">ReferenceURLs</span>             :
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Replaces</span>                  :
</span></span><span style="display:flex;"><span><span style="color:#e06c75">StatelessReady</span>            : <span style="color:#e06c75">True</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Status</span>                    :
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Summary</span>                   : <span style="color:#e06c75">VMware</span> <span style="color:#e06c75">Tools</span> <span style="color:#e06c75">VIB</span> <span style="color:#c678dd">for</span> <span style="color:#e06c75">Windows</span> <span style="color:#e06c75">and</span> <span style="color:#e06c75">Linux</span> <span style="color:#e06c75">guests</span> (<span style="color:#e06c75">generated</span> <span style="color:#e06c75">by</span> <span style="color:#e06c75">ESXi</span> <span style="color:#e06c75">server</span> <span style="color:#e06c75">build</span> <span style="color:#d19a66">16701467</span>)
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Tags</span>                      :
</span></span><span style="display:flex;"><span><span style="color:#e5c07b">Type </span>                     : <span style="color:#e06c75">locker</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Vendor</span>                    : <span style="color:#e06c75">VMware</span>
</span></span><span style="display:flex;"><span><span style="color:#e06c75">Version</span>                   : <span style="color:#d19a66">11.1</span>.<span style="color:#e06c75">1</span>.<span style="color:#d19a66">16303738</span>-<span style="color:#d19a66">16701467</span>
</span></span></code></pre></div>
</div>

<div class="code-caption">
    <span>Supplying arguments to the `Invoke()` method using the `CreateArgs()` helper.</span>
</div>

</li>
</ol>
<h2 id="conclusion">Conclusion</h2>
<p>In this tutorial, you&rsquo;ve learned how to create an <code>esxcli</code> interface in PowerCLI using the <code>Get-EsxCli</code> cmdlet. You then learned how to investigate the namespace hierarchy and invoke <code>esxcli</code> commands with or without arguments, as required. I hope you&rsquo;ve found this interesting and thanks for reading!</p>

    </section>

</article>

<section class="footer-cta">
    <div class="inner">
        <h2>Sign up for more like this.</h2>
        <a class="footer-cta-button su-modal-open-button" href="#/subscribe">
            <div>Enter your email</div>
            <span>Subscribe</span>
        </a>
    </div>
</section>

<aside class="read-more-wrap">
    <div class="read-more inner">
        
        
        
        <article class="post-card">

    
    
        <a class="post-card-image-link" href="https://ryanjan.uk/add-hard-disks-async-with-powercli/">
            <img class="post-card-image" src="/images/2019/10/wait-image.jpg" loading="lazy" />
        </a>
    

    <div class="post-card-content">
        <a class="post-card-content-link" href="https://ryanjan.uk/add-hard-disks-async-with-powercli/">
            <header class="post-card-header">
                
                
                
                <div class="post-card-primary-tag">powercli</div>
                
                
                <h2 class="post-card-title">Add Hard Disks to VMs Asynchronously with PowerCLI</h2>
            </header>
            <section class="post-card-excerpt">
                <p>At the time of writing the <code>New-HardDisk</code> PowerCLI CmdLet does not yet have a <code>-RunAsync</code> parameter. I found this out when trying to create a new 300 GiB eagerly zeroed disk on multiple VMs in one go. I soon realised that I was going to be sat there for a long time as each new disk was being formatted one at a time.</p>
            </section>
        </a>

        <footer class="post-card-meta">
            
            
            
            
            
            
            <ul class="author-list">
                <li class="author-list-item">
                    
                    <a href="https://ryanjan.uk/authors/ryan/" class="static-avatar">
                        
                        <img class="author-profile-image" src="/authors/ryan/avatar_hu2133b973be59ca79693e44e4bc908b85_51876_60x60_fill_q75_box_center.jpg" />
                    </a>
                </li>
            </ul>
            
            <div class="post-card-byline-content">
                
                <a href="https://ryanjan.uk/authors/ryan/">Ryan Kowalewski</a>
                
                <span class="post-card-byline-date">15 Oct 2019 <span class="bull"> &bull; </span>
                    3 min read</span>
            </div>
            
            
        </footer>
    </div>
</article>
        
        <article class="post-card">

    
    
        <a class="post-card-image-link" href="https://ryanjan.uk/get-host-cdp-info-with-powercli/">
            <img class="post-card-image" src="/images/2019/02/cisco-logo-16x9-2-1.jpg" loading="lazy" />
        </a>
    

    <div class="post-card-content">
        <a class="post-card-content-link" href="https://ryanjan.uk/get-host-cdp-info-with-powercli/">
            <header class="post-card-header">
                
                
                
                <div class="post-card-primary-tag">powercli</div>
                
                
                <h2 class="post-card-title">Get ESXi Host CDP Info With PowerCLI</h2>
            </header>
            <section class="post-card-excerpt">
                <p>I recently had to provide our networking team with a list of ESXi hosts and which switchports each of their physical NICs were connected to. Like many other environments, we are primarily a Cisco house and therefore I was able to get this data by querying the Cisco Discovery Protocol (CDP) information via PowerCLI. Here is how I went about it.</p>
            </section>
        </a>

        <footer class="post-card-meta">
            
            
            
            
            
            
            <ul class="author-list">
                <li class="author-list-item">
                    
                    <a href="https://ryanjan.uk/authors/ryan/" class="static-avatar">
                        
                        <img class="author-profile-image" src="/authors/ryan/avatar_hu2133b973be59ca79693e44e4bc908b85_51876_60x60_fill_q75_box_center.jpg" />
                    </a>
                </li>
            </ul>
            
            <div class="post-card-byline-content">
                
                <a href="https://ryanjan.uk/authors/ryan/">Ryan Kowalewski</a>
                
                <span class="post-card-byline-date">10 Feb 2019 <span class="bull"> &bull; </span>
                    6 min read</span>
            </div>
            
            
        </footer>
    </div>
</article>
        
        <article class="post-card">

    
    
        <a class="post-card-image-link" href="https://ryanjan.uk/powershell-tips-script-optimization/">
            <img class="post-card-image" src="/images/2018/06/lum3n-193427-unsplash.jpg" loading="lazy" />
        </a>
    

    <div class="post-card-content">
        <a class="post-card-content-link" href="https://ryanjan.uk/powershell-tips-script-optimization/">
            <header class="post-card-header">
                
                
                
                <div class="post-card-primary-tag">powershell</div>
                
                
                <h2 class="post-card-title">PowerShell Tips: Script Optimization</h2>
            </header>
            <section class="post-card-excerpt">
                <p>Introduction A colleague of mine recently asked for some help with a script he was writing. We use vSphere tags in order to determine which backup schedule a given VM is in and he wanted to find all VMs which were not assigned a tag in the category backup-service-level, and therefore were not being backed up. His actual query was regarding filtering out certain VMs which will never be given a backup tag.</p>
            </section>
        </a>

        <footer class="post-card-meta">
            
            
            
            
            
            
            <ul class="author-list">
                <li class="author-list-item">
                    
                    <a href="https://ryanjan.uk/authors/ryan/" class="static-avatar">
                        
                        <img class="author-profile-image" src="/authors/ryan/avatar_hu2133b973be59ca79693e44e4bc908b85_51876_60x60_fill_q75_box_center.jpg" />
                    </a>
                </li>
            </ul>
            
            <div class="post-card-byline-content">
                
                <a href="https://ryanjan.uk/authors/ryan/">Ryan Kowalewski</a>
                
                <span class="post-card-byline-date">02 Jun 2018 <span class="bull"> &bull; </span>
                    3 min read</span>
            </div>
            
            
        </footer>
    </div>
</article>
        
        
    </div>
</aside>

    </main>
    <footer class="site-footer outer">
    <div class="inner">
        <section class="copyright"><a href="https://ryanjan.uk/"></a> &copy; 2023</section>
        <nav class="site-footer-nav">
            <a href="https://ryanjan.uk/">Latest Posts</a>
            <a href="https://github.com/ryan-jan" target="_blank" rel="noopener">GitHub</a>
            <a href="https://twitter.com/_ryanjan_" target="_blank" rel="noopener">Twitter</a>
        </nav>
    </div>
</footer>
  </div>

  <div id="signup-modal" class="su-modal">
    <div class="su-modal-wrapper">
      <div class="su-modal-container">
        <div class="su-modal-content">
          <span class="su-modal-closeicon">&times;</span>
          <header class="su-modal-signup-header"><img class="su-modal-signup-logo" src="/images/cp-favicon.png"
              alt="RyanJan">
            
          </header>
          <form
            action="https://ryanjan.us1.list-manage.com/subscribe/post?u=60a6496a899e75ef8efe2e2ce&amp;id=9265c5169c"
            method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate"
            target="_blank" novalidate>
            <div class="su-modal-section">
              <section class="su-modal-input-section">
                <div class="su-modal-input-labelcontainer">
                  <label for="input-name" class="su-modal-input-label">Name</label>
                </div>
                <input type="text" value="" name="NAME" class="su-modal-input" id="input-name" placeholder="Joe Bloggs">
              </section>
              <section class="su-modal-input-section">
                <div class="su-modal-input-labelcontainer">
                  <label for="input-email" class="su-modal-input-label">Email</label>
                </div>
                <input type="email" value="" name="EMAIL" class="su-modal-input" id="input-email"
                  placeholder="joe.bloggs@example.com">
              </section>
              
              <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text"
                  name="b_60a6496a899e75ef8efe2e2ce_9265c5169c" tabindex="-1" value=""></div>

              <button class="su-modal-btn su-modal-btn-main su-modal-btn-primary" type="submit"
                style="color: rgb(255, 255, 255); background-color: rgb(0, 0, 0); opacity: 1; pointer-events: auto; width: 100%;">Sign
                up</button>

              <div id="mce-responses" class="clear">
                <div class="response" id="mce-error-response" style="display:none"></div>
                <div class="response" id="mce-success-response" style="display:none"></div>
              </div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <script type='text/javascript' src='//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js'></script>
  <script
    type='text/javascript'>(function ($) { window.fnames = new Array(); window.ftypes = new Array(); fnames[1] = 'NAME'; ftypes[1] = 'text'; fnames[0] = 'EMAIL'; ftypes[0] = 'email'; }(jQuery)); var $mcj = jQuery.noConflict(true);</script>

  
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"
    integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous">
    </script>
  <script src="/js/casper.js"></script>
  <script>
    $(document).ready(function () {
      
      $('.gh-burger').click(function () {
        $('body').toggleClass('gh-head-open');
      });
      
      $(".gh-content").fitVids();
    });
  </script>

  
  <script type="text/javascript" src="/js/custom/custom.js"></script>

  
</body>

</html>